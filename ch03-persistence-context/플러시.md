## 플러시(flush)

- 플러시(flush())는 영속성 컨텍스트의 변경 내용을 DB에 반영한다.

  즉, 쓰기 지연 SQL 저장소의 쿼리를 DB에 전송한다.



### 플러시하는 방법 3가지

1. 직접 호출
   - em.flush() 메서드를 직접 호출해서 영속성 컨텍스트를 강제로 플러시한다.
   - 테스트나 다른 프레임워크와 JPA를 함께 사용할 때를 제외하고 거의 사용하지 않는다.
2. 트랜잭션 커밋 시 자동 플러시 호출
   - DB에 변경 내용을 SQL로 전달하지 않고 트랙잭션만 커밋하면 어떤 데이터도 DB에 반영되지 않는다.
     따라서 트랜잭션을 커밋하기 전에 반드시 플러시를 호출해야한다.
   - JPA는 트랜잭션 커밋 시 플러시를 자동으로 호출한다.
3. JPQL 쿼리 실행 시 플러시 자동 호출
   - JPQL이나 Criteria 같은 객체지향 쿼리를 호출할 때도 플러시가 실행된다.
   - 참고로 식별자를 기준으로 조회하는 find() 메서드를 호출할 때는 플러시가 실행되지 않는다.



### 플러시 모드 옵션

javax.persistence.FlushModeType 을 사용해서 플러시 모드를 직접 지정할 수 있다.

- FlushModeType.AUTO : 커밋이나 쿼리를 실행할 때 플러시(기본값)
- FlushModeType.COMMIT : 커밋할 때만 플러시